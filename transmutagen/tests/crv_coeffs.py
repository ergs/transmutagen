"""
exp(-t) on [0, oo) best CRAM coefficients from the appendix of the paper
"Extended Numerical Computations on the '1/9' Conjecture in Rational
Approximation Theory", A. J. Carpenter, A. Ruttan, and R.S. Varga

The coefficients have been OCRed from https://finereaderonline.com which uses
Abbyy, and verified by hand.

p are the numerator coefficients and q are the denominator coefficients. They
are ordered from the 0th (constant) to the nth (t**n) term. The constant term
in the denominator is always normalized to 1.

To regenerate the coefficients in this file from the data, use

    python -m transmutagen.tests.crv_coeffs parse-coeffs

To test the coefficients in this file against the data, use

    python -m transmutagen.tests.crv_coeffs parse-coeffs --check-existing

To generate and plot a rational function expression of degree n from the
coefficients in this file, use

    python -m transmutagen.tests.crv_coeffs plot n

where n is from 1-30.

"""

import os
import re
import pprint
import difflib
from ..partialfrac import t

# This is generated from this file. Do not edit by hand. Rather, edit the
# transmutagen/tests/data/crv_coeffs file and generate it with
#
# python -m transmutagen.tests.crv_coeffs parse-coeffs

coeffs = \
{1: {'p': ['1.0668310421618504635e+0',
           '-1.1542504579210602494e-1'],
     'q': ['1.0000000000000000000e+0',
           '1.7271172505820169235e+0']},
 2: {'p': ['9.9264132983041947072e-1',
           '-1.8833350198927415815e-1',
           '4.2109959068982177855e-3'],
     'q': ['1.0000000000000000000e+0',
           '6.6930154271087127186e-1',
           '5.7224957904836489341e-1']},
 3: {'p': ['1.0007993806363356878e+0',
           '-2.2365742718351887787e-1',
           '1.2499601545398984435e-2',
           '-9.9810015898578281854e-5'],
     'q': ['1.0000000000000000000e+0',
           '7.9829357089752213329e-1',
           '2.2040971161511489626e-1',
           '1.2485918642725863159e-1']},
 4: {'p': ['9.9991347759304711148e-1',
           '-2.4025402432545953884e-1',
           '1.8400562307678039215e-2',
           '-4.4981502907081176448e-4',
           '1.6765299308108737248e-6'],
     'q': ['1.0000000000000000000e+0',
           '7.5668306888329708214e-1',
           '2.9175397633746512345e-1',
           '4.5750548404322635677e-2',
           '1.9376829538777680730e-2']},
 5: {'p': ['1.0000093457131530266e+0',
           '-2.5023100706418111745e-1',
           '2.2480613306965212876e-2',
           '-8.3363085734239059333e-4',
           '1.0779810679092561383e-5',
           '-2.1912697469186570498e-8'],
     'q': ['1.0000000000000000000e+0',
           '7.5017443629508826484e-1',
           '2.6991013134417674897e-1',
           '6.7668626041566587102e-2',
           '6.9346135560032124409e-3',
           '2.3446790106210413736e-3']},
 6: {'p': ['9.9999899154562510033e-1',
           '-2.5677508985594545088e-1',
           '2.5389670322537157467e-2',
           '-1.1769059339745022305e-3',
           '2.4820964613817624866e-5',
           '-1.9070014316258941354e-7',
           '2.3426628258627078732e-10'],
     'q': ['1.0000000000000000000e+0',
           '7.4317310793725353126e-1',
           '2.6898234032991615456e-1',
           '6.1593026160813895476e-2',
           '1.1364907743793030262e-2',
           '8.2567981485296730024e-4',
           '2.3230231175265367241e-4']},
 7: {'p': ['1.0000001087497491375e+0',
           '-2.6139890245157325374e-1',
           '2.7548737236512233353e-2',
           '-1.4675743675443654044e-3',
           '4.0604885270256007598e-5',
           '-5.3705891418335754085e-7',
           '2.6538677816935889717e-9',
           '-2.1189028316079702843e-12'],
     'q': ['1.0000000000000000000e+0',
           '7.3860755265403652073e-1',
           '2.6609542167331571699e-1',
           '6.2210380540681505225e-2',
           '1.0229633036518400366e-2',
           '1.4878817819751908909e-3',
           '8.0883914233407339765e-5',
           '1.9484208914619273525e-5']},
 8: {'p': ['9.9999998827734788367e-1',
           '-2.6483430847822992853e-1',
           '2.9207044273505478870e-2',
           '-1.7107715899069427972e-3',
           '5.6307821021754562350e-5',
           '-1.0147775758029899384e-6',
           '9.0013440975771190466e-9',
           '-3.0312488609110424332e-11',
           '1.6608075800347647028e-14'],
     'q': ['1.0000000000000000000e+0',
           '7.3516490200874711006e-1',
           '2.6438044169339228008e-1',
           '6.1718734777325241574e-2',
           '1.0520815163731983883e-2',
           '1.3283453064064323585e-3',
           '1.5910254290684040602e-4',
           '6.7271456842176719503e-6',
           '1.4167507178008938403e-6']},
 9: {'p': ['1.0000000012632924833e+0',
           '-2.6748589953942883104e-1',
           '3.0517580603500653821e-2',
           '-1.9147812452801917483e-3',
           '7.1103869037310644849e-5',
           '-1.5678080149581536439e-6',
           '1.9535758505225041515e-8',
           '-1.2209626369889029705e-10',
           '2.9287304416715685077e-13',
           '-1.1485167207995354803e-16'],
     'q': ['1.0000000000000000000e+0',
           '7.3251419564078598353e-1',
           '2.6303062535807977162e-1',
           '6.1530784916685721148e-2',
           '1.0492608831391450658e-2',
           '1.3950029476562314910e-3',
           '1.4116049483486023948e-4',
           '1.4351266620345007596e-5',
           '4.8597568414012272418e-7',
           '9.0914553514881083438e-8']},
 10: {'p': ['9.9999999986388794767e-1',
            '-2.6959370125162598429e-1',
            '3.1577898264638956869e-2',
            '-2.0872336141098597946e-3',
            '8.4694800522056656479e-5',
            '-2.1529632009223805112e-6',
            '3.3595495648065426068e-8',
            '-3.0243887922221152380e-10',
            '1.3835175675810288679e-12',
            '-2.4479596835781524301e-15',
            '7.1060202430410289851e-19'],
      'q': ['1.0000000000000000000e+0',
            '7.3040628740509415862e-1',
            '2.6198433793450755661e-1',
            '6.1359835762604515656e-2',
            '1.0522214938304485349e-2',
            '1.4004400136031827693e-3',
            '1.5162908445438365994e-4',
            '1.2670597578885658604e-5',
            '1.1179771406674077683e-6',
            '3.1024563729347710543e-8',
            '5.2207134645030587538e-9']},
 11: {'p': ['1.0000000000146631119e+0',
            '-2.7130906619020039085e-1',
            '3.2452672671798064591e-2',
            '-2.2343529914673730280e-3',
            '9.7033279144419487693e-5',
            '-2.7417852073123794696e-6',
            '5.0236657702890298313e-8',
            '-5.7755502193955032327e-10',
            '3.8862322897518799981e-12',
            '-1.3413459199227922075e-14',
            '1.8010050564587997692e-17',
            '-3.9776945578255130913e-21'],
      'q': ['1.0000000000000000000e+0',
            '7.2869093514903338347e-1',
            '2.6114358806002462135e-1',
            '6.1230547379183840216e-2',
            '1.0537271208026105008e-2',
            '1.4150097974152344401e-3',
            '1.5333091232704136771e-4',
            '1.3934767796316549369e-5',
            '9.8315547981894275422e-7',
            '7.6575875007520006935e-8',
            '1.7740700295278932878e-9',
            '2.7127219457634251348e-10']},
 12: {'p': ['9.9999999999842054316e-1',
            '-2.7273205541723861212e-1',
            '3.3186285409181941015e-2',
            '-2.3610296684603661423e-3',
            '1.0818210684852625702e-4',
            '-3.3170690870773473397e-6',
            '6.8564050007593925822e-8',
            '-9.4025623763914245637e-10',
            '8.2159261557706839823e-12',
            '-4.2460559325998987934e-14',
            '1.1335755380226379804e-16',
            '-1.1824226782945190429e-19',
            '2.0328884594951322377e-23'],
      'q': ['1.0000000000000000000e+0',
            '7.2726794442587404691e-1',
            '2.6045423235897757189e-1',
            '6.1125881342176750711e-2',
            '1.0551656317596859800e-2',
            '1.4248371121782907054e-3',
            '1.5627772051583776268e-4',
            '1.4198481758017543395e-5',
            '1.1076204551770729043e-6',
            '6.7122345531815556515e-8',
            '4.6772292551801273223e-9',
            '9.1859907864599662598e-11',
            '1.2870807304176959932e-11']},
 13: {'p': ['1.0000000000001701187e+0',
            '-2.7393143353638373887e-1',
            '3.3810123496675834027e-2',
            '-2.4710700386539540993e-3',
            '1.1824617529896343260e-4',
            '-3.8691771493804491498e-6',
            '8.7846766808947538873e-8',
            '-1.3766793766013695399e-9',
            '1.4546096489288275848e-11',
            '-9.9041130338816606894e-14',
            '4.0201482804353265611e-16',
            '-8.4753849754741511891e-19',
            '7.0050690177811160395e-22',
            '-9.5581127116884329757e-26'],
      'q': ['1.0000000000000000000e+0',
            '7.2606856648187456846e-1',
            '2.5987868966049413531e-1',
            '6.1040005208020200371e-2',
            '1.0563659959887015315e-2',
            '1.4333960951724789950e-3',
            '1.5836802154851644352e-4',
            '1.4609445035018602359e-5',
            '1.1372692221789108095e-6',
            '7.7482794810543576337e-8',
            '4.0886476353685167018e-9',
            '2.5766613699837803265e-10',
            '4.3455473513268560364e-12',
            '5.6184959576874667073e-13']},
 14: {'p': ['9.9999999999998167826e-1',
            '-2.7495599893993723129e-1',
            '3.4346972429252957162e-2',
            '-2.5674425707902795730e-3',
            '1.2734060684477834084e-4',
            '-4.3932761847806353276e-6',
            '1.0753187241762202746e-7',
            '-1.8710223403465319988e-9',
            '2.2849466635625509298e-11',
            '-1.9038591551025381666e-13',
            '1.0310120249635897805e-15',
            '-3.3490171642170337489e-18',
            '5.6743670690330211959e-21',
            '-3.7794532322670955969e-24',
            '4.1610013267680029528e-28'],
      'q': ['1.0000000000000000000e+0',
            '7.2504400105794982801e-1',
            '2.5939097352682523362e-1',
            '6.0968196803506752125e-2',
            '1.0574051936471402715e-2',
            '1.4405532019175131023e-3',
            '1.6019218139205361453e-4',
            '1.4908242237501135777e-5',
            '1.1820298688854366697e-6',
            '8.0164052804759260531e-8',
            '4.8361843519832766389e-9',
            '2.2472046467801857194e-10',
            '1.2022822504467751142e-11',
            '1.8921825619816040160e-13',
            '2.2710727625899900737e-14']},
 15: {'p': ['1.0000000000000019731e+0',
            '-2.7584133092403855215e-1',
            '3.4813754481829550920e-2',
            '-2.6524779865394277857e-3',
            '1.3557652521034370441e-4',
            '-4.8874813823443484833e-6',
            '1.2722046758585241530e-7',
            '-2.4081661405899631864e-9',
            '3.2966530346210070367e-11',
            '-3.2068470095050508776e-13',
            '2.1476966393883189321e-15',
            '-9.4109689260605595636e-18',
            '2.4856294581031545360e-20',
            '-3.4361705671901568590e-23',
            '1.8714400301425160987e-26',
            '-1.6864826197411413312e-30'],
      'q': ['1.0000000000000000000e+0',
            '7.2415866907620477911e-1',
            '2.5897242355314705843e-1',
            '6.0907277733570110800e-2',
            '1.0583087170044096379e-2',
            '1.4466872665940473451e-3',
            '1.6173222871264890572e-4',
            '1.5171907890884190088e-5',
            '1.2151064697266154881e-6',
            '8.4196487972429069905e-8',
            '5.0409480029770692861e-9',
            '2.7233683230693980458e-10',
            '1.1248069393139919485e-11',
            '5.9468225157795131984e-13',
            '7.6317957265269706634e-15',
            '8.5472063683108394376e-16']},
 16: {'p': ['9.9999999999999978751e-1',
            '-2.7661397707802372040e-1',
            '3.5223290398593890975e-2',
            '-2.7280223945541603972e-3',
            '1.4305532540830578363e-4',
            '-5.3516653691319551221e-6',
            '1.4663511678787708208e-7',
            '-2.9748521541610146711e-9',
            '4.4667074036373546096e-11',
            '-4.9124750188063887407e-13',
            '3.8755282930914110147e-15',
            '-2.1199503237701174494e-17',
            '7.6277421016130829045e-20',
            '-1.6607979818792513091e-22',
            '1.8979708477544314608e-25',
            '-8.5606377701670908334e-29',
            '6.3943444171177598099e-33'],
      'q': ['1.0000000000000000000e+0',
            '7.2338602292194837605e-1',
            '2.5860931332113989163e-1',
            '6.0854946127264699182e-2',
            '1.0591015301175281646e-2',
            '1.4519917779283776247e-3',
            '1.6306180422515751551e-4',
            '1.5396764745302603497e-5',
            '1.2446986743617001063e-6',
            '8.7213007002183174707e-8',
            '5.3517844906526438896e-9',
            '2.8593027098738583509e-10',
            '1.3963572572460278486e-11',
            '5.1671893800279173586e-13',
            '2.5276802007963606269e-14',
            '2.8667698160212141620e-16',
            '3.0093104224231407541e-17']},
 17: {'p': ['1.0000000000000000229e+0',
            '-2.7729414537863365694e-1',
            '3.5585465335003458111e-2',
            '-2.7955519228564120076e-3',
            '1.4986697693060245133e-4',
            '-5.7867107664997448463e-6',
            '1.6558969231502529775e-7',
            '-3.5600331752523462572e-9',
            '5.7694610687453000688e-11',
            '-7.0111135292795387525e-13',
            '6.3018857979045448319e-15',
            '-4.0934546068922329038e-17',
            '1.8540997178336935538e-19',
            '-5.5478662451290864179e-22',
            '1.0077964568000473113e-24',
            '-9.6311299616434657123e-28',
            '3.6381008264169349244e-31',
            '-2.2774706078188437603e-35'],
      'q': ['1.0000000000000000000e+0',
            '7.2270585462136953087e-1',
            '2.5829131995630046565e-1',
            '6.0809507390072969545e-2',
            '1.0598023489381217368e-2',
            '1.4566258090943959608e-3',
            '1.6421910387421514909e-4',
            '1.5592669068294270482e-5',
            '1.2701896118955897646e-6',
            '8.9952033533504590178e-8',
            '5.5866285320057224635e-9',
            '3.0690410653109898959e-10',
            '1.4763544085912781412e-11',
            '6.5692146982166977577e-13',
            '2.1929711332561360156e-14',
            '9.9803140529347369232e-16',
            '1.0076443559489818370e-17',
            '9.9533336444995010637e-19']},
 18: {'p': ['9.9999999999999999754e-1',
            '-2.7789748837786202942e-1',
            '3.5908020274519729805e-2',
            '-2.8562580858878249220e-3',
            '1.5609017337127136364e-4',
            '-6.1940471597288549472e-6',
            '1.8396482187296904295e-7',
            '-4.1548085790428176917e-9',
            '7.1794537028167480115e-11',
            '-9.4773868843647724074e-13',
            '9.4758123475451790323e-15',
            '-7.0617684389507100553e-17',
            '3.8258499143063765432e-19',
            '-1.4520088830640599985e-21',
            '3.6534688613148991179e-24',
            '-5.5958102671944549554e-27',
            '4.5177277417421400742e-30',
            '-1.4434969618996796174e-33',
            '7.6480564016753553998e-38'],
      'q': ['1.0000000000000000000e+0',
            '7.2210251162213760760e-1',
            '2.5801053189666607896e-1',
            '6.0769684666293474499e-2',
            '1.0604260828765657181e-2',
            '1.4607084457312575111e-3',
            '1.6523598870223731736e-4',
            '1.5764526871377682191e-5',
            '1.2926132501100778041e-6',
            '9.2334736432550722847e-8',
            '5.8031481469953154253e-9',
            '3.2288400362818480622e-10',
            '1.6023022340045240158e-11',
            '6.9925714572325997863e-13',
            '2.8542945098191319824e-14',
            '8.6471483697462350423e-16',
            '3.6787450097487522068e-17',
            '3.3278408185195843503e-19',
            '3.1040251435758619580e-20']},
 19: {'p': ['1.0000000000000000003e+0',
            '-2.7843631740798340183e-1',
            '3.6197101505900533482e-2',
            '-2.9111115140177481016e-3',
            '1.6179325924143951781e-4',
            '-6.5753674125082918706e-6',
            '2.0168905169819757417e-7',
            '-4.7521805561279600593e-9',
            '8.6730006775887139868e-11',
            '-1.2276354018264591744e-12',
            '1.3411822822603597433e-14',
            '-1.1186004966950956669e-16',
            '6.9970429220569463847e-19',
            '-3.1972725111092105805e-21',
            '1.0273733186333559896e-23',
            '-2.1951396392431808895e-26',
            '2.8615408787772833807e-29',
            '-1.9694708209381382654e-32',
            '5.3703307695262059488e-36',
            '-2.4294725589568881359e-40'],
      'q': ['1.0000000000000000000e+0',
            '7.2156368259201663937e-1',
            '2.5776078409791612555e-1',
            '6.0734497954567183445e-2',
            '1.0609846263465004573e-2',
            '1.4643324939311864714e-3',
            '1.6613650526094958487e-4',
            '1.5916587025359119477e-5',
            '1.3124457578828000080e-6',
            '9.4451373237383608747e-8',
            '5.9933092623793340401e-9',
            '3.3784614979453334011e-10',
            '1.6989658352357050158e-11',
            '7.6742363437140323820e-13',
            '3.0580043687699495419e-14',
            '1.1518577416976816152e-15',
            '3.1835397068991986730e-17',
            '1.2713653178005351833e-18',
            '1.0364344279541674044e-20',
            '9.1570582958910789228e-22']},
 20: {'p': ['9.9999999999999999997e-1',
            '-2.7892044834853562839e-1',
            '3.6457649932613876971e-2',
            '-2.9609098242596261130e-3',
            '1.6703541699804974713e-4',
            '-6.9324562692610725077e-6',
            '2.1872483964129629603e-7',
            '-5.3467565092977333192e-9',
            '1.0228954715465658016e-10',
            '-1.5368313511438283042e-12',
            '1.8096461988824864400e-14',
            '-1.6580745736734816354e-16',
            '1.1672198605029734819e-18',
            '-6.1936889537571481080e-21',
            '2.4105681922839642535e-23',
            '-6.6185196281694492006e-26',
            '1.2113724541256915285e-28',
            '-1.3552946153009542146e-31',
            '8.0169605314221382434e-35',
            '-1.8805470199361703461e-38',
            '7.3216143452337990707e-43'],
      'q': ['1.0000000000000000000e+0',
            '7.2107955165146436895e-1',
            '2.5753720158407837071e-1',
            '6.0703182600751914030e-2',
            '1.0614875834295449959e-2',
            '1.4675710228275782849e-3',
            '1.6693957290448895787e-4',
            '1.6052079646727331527e-5',
            '1.3301225337360296890e-6',
            '9.6338964603806016053e-8',
            '6.1639056613443707964e-9',
            '3.5110926854287101220e-10',
            '1.7908832457629530219e-11',
            '8.2008117841834923615e-13',
            '3.3938864156618761186e-14',
            '1.2417688637946327705e-15',
            '4.3385159620628243371e-17',
            '1.0990484330810003653e-18',
            '4.1354019630164880823e-20',
            '3.0538918819268542585e-22',
            '2.5628928552136086178e-23']},
 21: {'p': ['1.0000000000000000000e+0',
            '-2.7935780302430817048e-1',
            '3.6693681977608392584e-2',
            '-3.0063138655381823795e-3',
            '1.7186787185029200536e-4',
            '-7.2670890316381390456e-6',
            '2.3505832195838590627e-7',
            '-5.9344580351910059567e-9',
            '1.1828954830323715653e-10',
            '-1.8712232943943080645e-12',
            '2.3495449807922150045e-14',
            '-2.3313838537000271146e-16',
            '1.8118842180441427473e-18',
            '-1.0875663018513674485e-20',
            '4.9414360113574654171e-23',
            '-1.6523102799180557777e-25',
            '3.9082049594935053126e-28',
            '-6.1754498246162749622e-31',
            '5.9746919108510846444e-34',
            '-3.0598920596277695902e-37',
            '6.2192394025759794712e-41',
            '-2.0988417714945058814e-45'],
      'q': ['1.0000000000000000000e+0',
            '7.2064219697569183005e-1',
            '2.5733587895330020783e-1',
            '6.0675133266582940643e-2',
            '1.0619427824397480596e-2',
            '1.4704823869739844457e-3',
            '1.6766020704056002618e-4',
            '1.6173579847685692566e-5',
            '1.3459762326494999013e-6',
            '9.8033984897602339980e-8',
            '6.3173038544853450718e-9',
            '3.6312508159412913565e-10',
            '1.8730981404230082919e-11',
            '8.7093081612820652481e-13',
            '3.6548676757025251170e-14',
            '1.3936848498319246143e-15',
            '4.7051616127896484209e-17',
            '1.5317669769113303944e-18',
            '3.5714624755160836554e-20',
            '1.2703379067012114642e-21',
            '8.5380603270749883481e-24',
            '6.8232509117901788034e-25']},
 22: {'p': ['1.0000000000000000000e+0',
            '-2.7975484477573114216e-1',
            '3.6908495635450404166e-2',
            '-3.0478754020575993647e-3',
            '1.7633500843928321830e-4',
            '-7.5809738495069090674e-6',
            '2.5069191557238854811e-7',
            '-6.5122619757180812495e-9',
            '1.3457379364976452568e-10',
            '-2.2268026983155948583e-12',
            '2.9560245331729836665e-14',
            '-3.1410724352013750719e-16',
            '2.6553887718291344662e-18',
            '-1.7676644378244532847e-20',
            '9.1278680283845964971e-23',
            '-3.5805166566755439172e-25',
            '1.0365955917689346517e-27',
            '-2.1277784397335996581e-30',
            '2.9231399336791845047e-33',
            '-2.4623396257008074572e-36',
            '1.0991176527978871486e-39',
            '-1.9484008877459215375e-43',
            '5.7367451049989032790e-48'],
      'q': ['1.0000000000000000000e+0',
            '7.2024515522426885778e-1',
            '2.5715365085971926369e-1',
            '6.0649864512193881866e-2',
            '1.0623566628151799912e-2',
            '1.4731137404802299197e-3',
            '1.6831048917843324445e-4',
            '1.6283152234777024234e-5',
            '1.3602761130470247007e-6',
            '9.9564343590539204149e-8',
            '6.4560913902503564972e-9',
            '3.7401859742633337134e-10',
            '1.9483106529080606242e-11',
            '9.1680999305772174791e-13',
            '3.9107766743159333128e-14',
            '1.5123507567108144027e-15',
            '5.3401899140075195528e-17',
            '1.6707425727208528640e-18',
            '5.0886706159921823345e-20',
            '1.0961475446293379047e-21',
            '3.6965545855001175030e-23',
            '2.2708806892898350258e-25',
            '1.7320983079796653153e-26']},
 23: {'p': ['1.0000000000000000000e+0',
            '-2.8011689917540408269e-1',
            '3.7104823892752821325e-2',
            '-3.0860584471325009762e-3',
            '1.8047536072786826345e-4',
            '-7.8757210411818256606e-6',
            '2.6563900673673161074e-7',
            '-7.0779812242602691625e-9',
            '1.5101143424472028548e-10',
            '-2.5997957789837943232e-12',
            '3.6233532714776076309e-14',
            '-4.0861034248600722572e-16',
            '3.7137851529683374768e-18',
            '-2.7001985390889146513e-20',
            '1.5528939801402053295e-22',
            '-6.9530886094237998157e-25',
            '2.3720625335812422216e-27',
            '-5.9872927305549306726e-30',
            '1.0736346677944520471e-32',
            '-1.2905749729715581657e-35',
            '9.5241140961329381142e-39',
            '-3.7278671871533691988e-42',
            '5.7982136100082272330e-46',
            '-1.4983223279431735600e-50'],
      'q': ['1.0000000000000000000e+0',
            '7.1988310082459591732e-1',
            '2.5698792471734873844e-1',
            '6.0626982524584947958e-2',
            '1.0627345664071083966e-2',
            '1.4755035992707838480e-3',
            '1.6890024843251700692e-4',
            '1.6382473993464912301e-5',
            '1.3732404247572612432e-6',
            '1.0095302286038609121e-7',
            '6.5822413182372985325e-9',
            '3.8394889629746827515e-10',
            '2.0170542366772364610e-11',
            '9.5918906854811887872e-13',
            '4.1436204320974462060e-14',
            '1.6304901228232053668e-15',
            '5.8386383707137038815e-17',
            '1.9175029935153725110e-18',
            '5.5808542257176158674e-20',
            '1.5960495536735968784e-21',
            '3.1871496109206449820e-23',
            '1.0217421583117155147e-24',
            '5.7595314217244562516e-27',
            '4.2015926344320482739e-28']},
 24: {'p': ['1.0000000000000000000e+0',
            '-2.8044839371939509988e-1',
            '3.7284950524883842970e-2',
            '-3.1212558501085499598e-3',
            '1.8432246866428426565e-4',
            '-8.1528290297762335410e-6',
            '2.7992015745235962935e-7',
            '-7.6300845409641694341e-9',
            '1.6749426980810398258e-10',
            '-2.9867405776081327288e-12',
            '4.3453522989129354348e-14',
            '-5.1625886299634749395e-16',
            '4.9974970771678653853e-18',
            '-3.9209132343147921877e-20',
            '2.4722281164775052693e-22',
            '-1.2376529579577131695e-24',
            '4.8389987731625314556e-27',
            '-1.4452601356069529738e-29',
            '3.2004921170130934113e-32',
            '-5.0438750863387113193e-35',
            '5.3360424355118835887e-38',
            '-3.4694587438114214128e-41',
            '1.1974216241920071748e-44',
            '-1.6430816452663319539e-48',
            '3.7467762281382790571e-53'],
      'q': ['1.0000000000000000000e+0',
            '7.1955160628060490012e-1',
            '2.5683655680548874312e-1',
            '6.0606164481744409458e-2',
            '1.0630809594431807553e-2',
            '1.4776837304194045942e-3',
            '1.6943756353916543523e-4',
            '1.6472921423980865550e-5',
            '1.3850483386300453833e-6',
            '1.0221886364132138740e-7',
            '6.6974106945354655796e-9',
            '3.9303598949948647010e-10',
            '2.0801904728762698738e-11',
            '9.9823495547390858172e-13',
            '4.3607684640656254187e-14',
            '1.7388589608575720948e-15',
            '6.3423901723117428381e-17',
            '2.1120571959754931088e-18',
            '6.4766664595094796687e-20',
            '1.7596348598140616683e-21',
            '4.7406321676460227043e-23',
            '8.8030256384366476434e-25',
            '2.6892325986479079123e-26',
            '1.3950597685006867882e-28',
            '9.7582905119403701973e-30']},
 25: {'p': ['1.0000000000000000000e+0',
            '-2.8075303939969450848e-1',
            '3.7450798588571201206e-2',
            '-3.1538023041200807920e-3',
            '1.8790560971052078695e-4',
            '-8.4136803468272165599e-6',
            '2.9356040915848232932e-7',
            '-8.1675511125608142608e-9',
            '1.8393384178735986993e-10',
            '-3.3845209609800166958e-12',
            '5.1157161639534070020e-14',
            '-6.3644923388319778193e-16',
            '6.5117237108438679018e-18',
            '-5.4595347139888024431e-20',
            '3.7273813754702834958e-22',
            '-2.0530724455614180911e-24',
            '9.0077109606214317012e-27',
            '-3.0948366861501914604e-29',
            '8.1407882328111744921e-32',
            '-1.5906727254440811555e-34',
            '2.2153039233678690245e-37',
            '-2.0736074544841591910e-40',
            '1.1940545565030128827e-43',
            '-3.6523509679158950883e-47',
            '4.4437519314004684085e-51',
            '-8.9869101966470571763e-56'],
      'q': ['1.0000000000000000000e+0',
            '7.1924696060030549152e-1',
            '2.5669775918887669273e-1',
            '6.0587143251270532876e-2',
            '1.0633996033260288963e-2',
            '1.4796805670782497197e-3',
            '1.6992913597947736280e-4',
            '1.6555634671491244526e-5',
            '1.3958482728461237761e-6',
            '1.0337750836440238611e-7',
            '6.8029738899716716771e-9',
            '4.0138303634825116937e-10',
            '2.1383556797380942966e-11',
            '1.0343638215272956605e-12',
            '4.5624243518361710181e-14',
            '1.8408841519514984572e-15',
            '6.8081267555534785131e-17',
            '2.3116269500240241604e-18',
            '7.1858776322636732020e-20',
            '2.0647764426693640793e-21',
            '5.2528760787303468994e-23',
            '1.3370915947538380277e-24',
            '2.3154233915482175675e-26',
            '6.7551774268161192942e-28',
            '3.2397074059310773266e-30',
            '2.1738952552926457167e-31']},
 26: {'p': ['1.0000000000000000000e+0',
            '-2.8103396995364592372e-1',
            '3.7603998823683417241e-2',
            '-3.1839846317881614457e-3',
            '1.9125041898775982050e-4',
            '-8.6595435825426075478e-6',
            '3.0658737713813768797e-7',
            '-8.6897545335970724597e-9',
            '2.0025861713950916330e-10',
            '-3.7903724436935358376e-12',
            '5.9282411666625107531e-14',
            '-7.6842585097056414965e-16',
            '8.2570666493171204585e-18',
            '-7.3392007703057431530e-20',
            '5.3712708293521833434e-22',
            '-3.2137958886540163074e-24',
            '1.5565082769644566430e-26',
            '-6.0214447480232786212e-29',
            '1.8284175028861242452e-31',
            '-4.2589594095915223042e-34',
            '7.3811490698898474272e-37',
            '-9.1298836604138566248e-40',
            '7.5983415064438853460e-43',
            '-3.8935547750075112746e-46',
            '1.0604684624677904373e-49',
            '-1.1493650186177443495e-53',
            '2.0710352729171641461e-58'],
      'q': ['1.0000000000000000000e+0',
            '7.1896603004635407628e-1',
            '2.5657002887003749352e-1',
            '6.0569695881738960595e-2',
            '1.0636936873433653069e-2',
            '1.4815162820564590937e-3',
            '1.7038057158576408119e-4',
            '1.6631566345893463369e-5',
            '1.4057642432742099133e-6',
            '1.0444204490518077866e-7',
            '6.9000857608018811274e-9',
            '4.0907662030930223269e-10',
            '2.1921125846523355118e-11',
            '1.0678718214314360999e-12',
            '4.7503981805777539255e-14',
            '1.9363701772525106571e-15',
            '7.2507250514592475300e-17',
            '2.4975442158093370662e-18',
            '7.9241460923961745271e-20',
            '2.3072848547429883203e-21',
            '6.2318770493623148075e-23',
            '1.4887308305062634160e-24',
            '3.5900145501058512309e-26',
            '5.8126365856240802587e-28',
            '1.6227799580300107200e-29',
            '7.2122228957098244519e-32',
            '4.6529920015189527423e-33']},
 27: {'p': ['1.0000000000000000000e+0',
            '-2.8129384986505035548e-1',
            '3.7745943082793112249e-2',
            '-3.2120499830101943170e-3',
            '1.9437941312076668187e-4',
            '-8.8915786943714812065e-6',
            '3.1902991377590222703e-7',
            '-9.1963709811680089503e-9',
            '2.1641140277115697685e-10',
            '-4.2018705007566813448e-12',
            '6.7769798099866907653e-14',
            '-9.1133406626101867879e-16',
            '1.0230254833623119193e-17',
            '-9.5764061479699012137e-20',
            '7.4512740901471078481e-22',
            '-4.7931707838444243896e-24',
            '2.5293126309095483331e-26',
            '-1.0834661026569340573e-28',
            '3.7161403305502155654e-31',
            '-1.0024877187066737147e-33',
            '2.0780918351231215531e-36',
            '-3.2097160980790598559e-39',
            '3.5424654128735486313e-42',
            '-2.6331524240973874715e-45',
            '1.2060058776911720646e-48',
            '-2.9375861296063709736e-52',
            '2.8484004094090161063e-56',
            '-4.5925891451883766222e-61'],
      'q': ['1.0000000000000000000e+0',
            '7.1870615013494964452e-1',
            '2.5645209321774275677e-1',
            '6.0553634833924406861e-2',
            '1.0639659327332069240e-2',
            '1.4832096123430519539e-3',
            '1.7079659574127093742e-4',
            '1.6701518602605391310e-5',
            '1.4149006878178168423e-6',
            '1.0542351021349550139e-7',
            '6.9897228455967626327e-9',
            '4.1619044516026066335e-10',
            '2.2419392381250479060e-11',
            '1.0990305718118410865e-12',
            '4.9259005778171551594e-14',
            '2.0260314782637897578e-15',
            '7.6681358771735639629e-17',
            '2.6758680762905260877e-18',
            '8.6169847303890952011e-20',
            '2.5634235918361219624e-21',
            '7.0127193297565789436e-23',
            '1.7855742180920933932e-24',
            '4.0156816304849403139e-26',
            '9.1964363393424183436e-28',
            '1.3955671627874349543e-29',
            '3.7352134986647930254e-31',
            '1.5427084484811426672e-33',
            '9.5834724343683731142e-35']},
 28: {'p': ['1.0000000000000000000e+0',
            '-2.8153495900022549142e-1',
            '3.7877826471550229077e-2',
            '-3.2382124179360921395e-3',
            '1.9731243218656025214e-4',
            '-9.1108440565059548173e-6',
            '3.3091718065250326410e-7',
            '-9.6873069289091329257e-9',
            '2.3234704839756243162e-10',
            '-4.6169087559105242168e-12',
            '7.6563385687590018588e-14',
            '-1.0642631862580357359e-15',
            '1.2424881652802987399e-17',
            '-1.2181315591198636789e-19',
            '1.0008004746340252594e-21',
            '-6.8628244877211120581e-24',
            '3.9041630685993974915e-26',
            '-1.8273116597117645173e-28',
            '6.9600084535166773350e-31',
            '-2.1270994500225483862e-33',
            '5.1221768334261579751e-36',
            '-9.4924644132126223194e-39',
            '1.3124217182547875882e-41',
            '-1.2979704782618576593e-44',
            '8.6529029938315506542e-48',
            '-3.5567748438917412531e-51',
            '7.7792379820555470653e-55',
            '-6.7753365272078992201e-59',
            '9.8138565931627609198e-64'],
      'q': ['1.0000000000000000000e+0',
            '7.1846504099977450858e-1',
            '2.5634286747132473766e-1',
            '6.0538801220168057895e-2',
            '1.0642186749988000749e-2',
            '1.4847764994109842628e-3',
            '1.7118121976301399562e-4',
            '1.6766171748975058231e-5',
            '1.4233461897756964635e-6',
            '1.0633127738462594514e-7',
            '7.0727167212993401677e-9',
            '4.2278753905749988235e-10',
            '2.2882484070110947837e-11',
            '1.1280736630891817950e-12',
            '5.0900982136752396390e-14',
            '2.1102989402066160773e-15',
            '8.0629352903914881994e-17',
            '2.8453127951750166544e-18',
            '9.2876348488845996777e-20',
            '2.8055162407493957644e-21',
            '7.8493728999571373376e-23',
            '2.0231282677112118888e-24',
            '4.8688630300634044605e-26',
            '1.0332584543810187690e-27',
            '2.2522930190976109514e-29',
            '3.2105491540280196138e-31',
            '8.2519544489273895218e-33',
            '3.1755253582770512366e-35',
            '1.9020809159366749124e-36']},
 29: {'p': ['1.0000000000000000000e+0',
            '-2.8175925956920689007e-1',
            '3.8000680884184294416e-2',
            '-3.2626582310163976817e-3',
            '2.0006701267299431847e-4',
            '-9.3183042499982610991e-6',
            '3.4227801419691581593e-7',
            '-1.0162642462709301594e-8',
            '2.4803044888644507226e-10',
            '-5.0336720080283779322e-12',
            '8.5611335339544449737e-14',
            '-1.2262802013924015446e-15',
            '1.4832100877490882467e-17',
            '-1.5158313990467185641e-19',
            '1.3074657548508829771e-21',
            '-9.4902885995221209857e-24',
            '5.7698403519637535860e-26',
            '-2.9188924120576619426e-28',
            '1.2179775468499820477e-30',
            '-4.1449405346182376688e-33',
            '1.1339292479243459054e-35',
            '-2.4481138035452179148e-38',
            '4.0730588289709086731e-41',
            '-5.0614377161525805088e-44',
            '4.5033487174180149912e-47',
            '-2.7029531453596257962e-50',
            '1.0009296137524799591e-53',
            '-1.9731092335931916942e-57',
            '1.5493207620467243315e-61',
            '-2.0235251334280446010e-66'],
      'q': ['1.0000000000000000000e+0',
            '7.1824074043079310993e-1',
            '2.5624142131497740435e-1',
            '6.0525059535231118368e-2',
            '1.0644539295547595500e-2',
            '1.4862305915618925334e-3',
            '1.7153787091780660524e-4',
            '1.6826106556886635018e-5',
            '1.4311763809427150035e-6',
            '1.0717335838264462378e-7',
            '7.1497799310138340033e-9',
            '4.2892213438580353073e-10',
            '2.3313973576581319597e-11',
            '1.1552060390438050984e-12',
            '5.2440069076448366312e-14',
            '2.1896191080064318492e-15',
            '8.4364220579657309921e-17',
            '3.0067321387130736625e-18',
            '9.9296151586572481448e-20',
            '3.0419849906975770270e-21',
            '8.6456065781235580902e-23',
            '2.2812963979843922853e-24',
            '5.5537857813866255467e-26',
            '1.2663351963339644273e-27',
            '2.5413421113019371806e-29',
            '5.2836220838809921666e-31',
            '7.0894030065454535655e-33',
            '1.7525818103023344647e-34',
            '6.2991336260625001585e-37',
            '3.6427133054769394938e-38']},
 30: {'p': ['1.0000000000000000000e+0',
            '-2.8196844957227872388e-1',
            '3.8115401913969740830e-2',
            '-3.2855502860341809776e-3',
            '2.0265870261805029904e-4',
            '-9.5148379859906376412e-6',
            '3.5314050182780261684e-7',
            '-1.0622586963885646562e-8',
            '2.6343483216755972319e-10',
            '-5.4506073294691798165e-12',
            '9.4866156508756075292e-14',
            '-1.3964554205647248956e-15',
            '1.7441252036441660423e-17',
            '-1.8506688650091489877e-19',
            '1.6676820706603970154e-21',
            '-1.2737164571814720528e-23',
            '8.2159993047662503208e-26',
            '-4.4525490040349927562e-28',
            '2.0130724366066200126e-30',
            '-7.5239822024090788005e-33',
            '2.2978810217829931996e-35',
            '-5.6508242227847947169e-38',
            '1.0982155012464389275e-40',
            '-1.6467595005222406689e-43',
            '1.8462045089123337587e-46',
            '-1.4832272593982169255e-49',
            '8.0441303745414552340e-53',
            '-2.6930919888571651980e-56',
            '4.8015689571472672268e-60',
            '-3.4109451463472630706e-64',
            '4.0308755782861197983e-69'],
      'q': ['1.0000000000000000000e+0',
            '7.1803155042772127612e-1',
            '2.5614695234169101695e-1',
            '6.0512293508462864581e-2',
            '1.0646734444855619090e-2',
            '1.4875836417649791494e-3',
            '1.7186949502113754284e-4',
            '1.6881821841067465703e-5',
            '1.4384562284711296335e-6',
            '1.0795664283018752186e-7',
            '7.2215265693946799983e-9',
            '4.3464114384271304094e-10',
            '2.3716969565318967420e-11',
            '1.1806074393066802850e-12',
            '5.3885346845345913909e-14',
            '2.2643856170276607118e-15',
            '8.7901123390735385090e-17',
            '3.1604309408297432480e-18',
            '1.0545543403758406495e-19',
            '3.2699924326595110152e-21',
            '9.4303280463436687932e-23',
            '2.5286339977569998853e-24',
            '6.3086412701711342899e-26',
            '1.4540002113970188434e-27',
            '3.1480227761306722217e-29',
            '5.9861194489977205340e-31',
            '1.1893082101510933116e-32',
            '1.5049933964043840759e-34',
            '3.5836255739795333870e-36',
            '1.2057358269368541653e-38',
            '6.7397798848782102402e-40']}}

def parse_crv_coeffs(file=os.path.join(os.path.dirname( __file__), 'data', 'crv_coeffs')):
    """
    Used to generate the below dictionaries from the OCRed file.
    """
    _coeffs = {}
    # Lines like
    # n = 12
    N = re.compile(r'n = (\d+)')
    # Lines like
    # 1 1.7271172505820169235 (+00) -1.1542504579210602494 (-01)
    COEFF = re.compile(r'(\d+) ([\d.-]+) \(([+-]\d\d)\) ([\d.-]+) \(([+-]\d\d)\)')

    with open(file) as f:
        coeffstxt = f.read()

    for line in coeffstxt.splitlines():
        m_n = N.match(line)
        m_coeff = COEFF.match(line)
        if m_n:
            n, = m_n.groups()
            n = int(n)
            if n in _coeffs:
                raise ValueError("n given twice: " + n)
            _coeffs[n] = {'p': [], 'q': []}
            continue
        elif m_coeff:
            i, qb, qe, pb, pe = m_coeff.groups()
            i = int(i)
            if not (len(_coeffs[n]['p']) == len(_coeffs[n]['q']) == i):
                raise ValueError('Unexpected i: ' + repr(i))
            qblen = 22 if '-' in qb else 21
            pblen = 22 if '-' in pb else 21
            if len(qb) != qblen:
                raise ValueError('Unexpected length for q: ' + repr(line))
            if len(pb) != pblen:
                raise ValueError('Unexpected length for p: ' + repr(line))

            # Remove leading 0 from exponent, to match Python %e formatting
            if qe[1] == '0':
                qe = qe[0] + qe[2]
            if pe[1] == '0':
                pe = pe[0] + pe[2]

            p = pb + 'e' + pe
            q = qb + 'e' + qe
            _coeffs[n]['p'].append(p)
            _coeffs[n]['q'].append(q)
        else:
            raise ValueError("Line did not match: " + repr(line))

    return _coeffs

def create_expression(n):
    if n not in coeffs:
        raise ValueError("Don't have coefficients for {}".format(n))

    from sympy import Float, Add

    p = coeffs[n]['p']
    q = coeffs[n]['q']

    # Don't use Poly here, it loses precision
    num = Add(*[Float(p[i])*t**i for i in range(n+1)])
    den = Add(*[Float(q[i])*t**i for i in range(n+1)])

    return num/den

def _plot(args):
    n = args.degree
    from sympy import exp

    from .. import plot_in_terminal

    rat_func = create_expression(n)

    print(rat_func)

    plot_in_terminal(rat_func - exp(-t), (0, 100), prec=20)

def _parse_coeffs(args):
    file = args.file
    check_existing = args.check_existing

    _coeffs = parse_crv_coeffs(file=file)

    if check_existing:
        for n in sorted(coeffs):
            for v in 'pq':
                print('Checking against', n, v)
                if _coeffs[n][v] == coeffs[n][v]:
                    print(n, v, "matches")
                else:
                    print(n, v, "doesn't match")
                    print(v, 'diff:')
                    print('\n'.join(difflib.ndiff(_coeffs[n][v], coeffs[n][v])))
    else:
        pprint.pprint(_coeffs, width=20)


if __name__ == '__main__':
    # Run this with
    # PYTHONPATH=/path/to/development/sympy python -m transmutagen.tests.crv_coeffs

    import argparse
    parser = argparse.ArgumentParser(description=__doc__, formatter_class=argparse.RawDescriptionHelpFormatter)

    subparser = parser.add_subparsers()

    plot = subparser.add_parser('plot', help='Plot a rational function')
    plot.add_argument('degree', type=int)
    plot.set_defaults(func=_plot)

    parse_coeffs = subparser.add_parser('parse-coeffs', help='Parse the coeffs in the data file')
    parse_coeffs.add_argument('--file', default=os.path.join(os.path.dirname(
        __file__), 'data', 'crv_coeffs'), help="Path to the crv_coeffs data file")
    parse_coeffs.add_argument('--check-existing', action='store_true',
        default=False, help="""Print a diff from the parsed coeffs and the
        existing ones in this file""")
    parse_coeffs.set_defaults(func=_parse_coeffs)

    # TODO: Add options for arguments to pass to various functions as needed.
    try:
        import argcomplete
        argcomplete.autocomplete(parser)
    except ImportError:
        pass
    args = parser.parse_args()
    if not hasattr(args, 'func'):
        parser.print_help()
        parser.error("no command given")
    args.func(args)
